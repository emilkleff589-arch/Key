--[[
    Custom Roblox UI Library
    Created for production use
    Executor-safe, mobile-compatible, no dependencies
]]--

local Library = {}
Library.__index = Library

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")

-- Utility Functions
local function Tween(instance, properties, duration, style, direction)
    local tweenInfo = TweenInfo.new(
        duration or 0.3,
        style or Enum.EasingStyle.Quad,
        direction or Enum.EasingDirection.Out
    )
    local tween = TweenService:Create(instance, tweenInfo, properties)
    tween:Play()
    return tween
end

local function MakeDraggable(frame, dragHandle)
    local dragging = false
    local dragInput, mousePos, framePos

    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            mousePos = input.Position
            framePos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    dragHandle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            Tween(frame, {Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)}, 0.1)
        end
    end)
end

local function CreateElement(className, properties)
    local element = Instance.new(className)
    for prop, value in pairs(properties) do
        element[prop] = value
    end
    return element
end

-- Theme System
Library.Themes = {
    Dark = {
        Background = Color3.fromRGB(20, 20, 25),
        Secondary = Color3.fromRGB(30, 30, 35),
        Tertiary = Color3.fromRGB(40, 40, 45),
        Accent = Color3.fromRGB(88, 101, 242),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(180, 180, 190),
        Border = Color3.fromRGB(60, 60, 70),
        Success = Color3.fromRGB(67, 181, 129),
        Warning = Color3.fromRGB(250, 166, 26),
        Error = Color3.fromRGB(240, 71, 71)
    },
    Light = {
        Background = Color3.fromRGB(245, 245, 250),
        Secondary = Color3.fromRGB(255, 255, 255),
        Tertiary = Color3.fromRGB(235, 235, 240),
        Accent = Color3.fromRGB(88, 101, 242),
        Text = Color3.fromRGB(20, 20, 30),
        SubText = Color3.fromRGB(100, 100, 120),
        Border = Color3.fromRGB(200, 200, 210),
        Success = Color3.fromRGB(67, 181, 129),
        Warning = Color3.fromRGB(250, 166, 26),
        Error = Color3.fromRGB(240, 71, 71)
    }
}

-- Create Window
function Library:CreateWindow(options)
    options = options or {}
    local WindowTitle = options.Title or "UI Library"
    local WindowSubtitle = options.Subtitle or "by Custom Library"
    local WindowSize = options.Size or UDim2.new(0, 580, 0, 460)
    local Theme = options.Theme or "Dark"
    local AccentColor = options.AccentColor or self.Themes[Theme].Accent

    -- Destroy existing UI
    pcall(function()
        if CoreGui:FindFirstChild("CustomLibraryUI") then
            CoreGui:FindFirstChild("CustomLibraryUI"):Destroy()
        end
    end)

    -- Create ScreenGui
    local ScreenGui = CreateElement("ScreenGui", {
        Name = "CustomLibraryUI",
        Parent = CoreGui,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false
    })

    -- Main Frame
    local MainFrame = CreateElement("Frame", {
        Name = "MainFrame",
        Parent = ScreenGui,
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = WindowSize,
        BackgroundColor3 = self.Themes[Theme].Background,
        BorderSizePixel = 0,
        ClipsDescendants = true
    })

    CreateElement("UICorner", {
        Parent = MainFrame,
        CornerRadius = UDim.new(0, 10)
    })

    CreateElement("UIStroke", {
        Parent = MainFrame,
        Color = self.Themes[Theme].Border,
        Thickness = 1.5,
        Transparency = 0.5
    })

    -- Shadow effect
    local Shadow = CreateElement("ImageLabel", {
        Name = "Shadow",
        Parent = MainFrame,
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(1, 30, 1, 30),
        BackgroundTransparency = 1,
        Image = "rbxassetid://6014261993",
        ImageColor3 = Color3.fromRGB(0, 0, 0),
        ImageTransparency = 0.7,
        ZIndex = 0
    })

    -- Top Bar
    local TopBar = CreateElement("Frame", {
        Name = "TopBar",
        Parent = MainFrame,
        Size = UDim2.new(1, 0, 0, 50),
        BackgroundColor3 = self.Themes[Theme].Secondary,
        BorderSizePixel = 0
    })

    CreateElement("UICorner", {
        Parent = TopBar,
        CornerRadius = UDim.new(0, 10)
    })

    local TopBarFill = CreateElement("Frame", {
        Parent = TopBar,
        Position = UDim2.new(0, 0, 1, -10),
        Size = UDim2.new(1, 0, 0, 10),
        BackgroundColor3 = self.Themes[Theme].Secondary,
        BorderSizePixel = 0
    })

    local TitleLabel = CreateElement("TextLabel", {
        Name = "TitleLabel",
        Parent = TopBar,
        Position = UDim2.new(0, 15, 0, 8),
        Size = UDim2.new(0.6, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = WindowTitle,
        TextColor3 = self.Themes[Theme].Text,
        TextSize = 16,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    local SubtitleLabel = CreateElement("TextLabel", {
        Name = "SubtitleLabel",
        Parent = TopBar,
        Position = UDim2.new(0, 15, 0, 28),
        Size = UDim2.new(0.6, 0, 0, 14),
        BackgroundTransparency = 1,
        Text = WindowSubtitle,
        TextColor3 = self.Themes[Theme].SubText,
        TextSize = 12,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    -- Close Button
    local CloseButton = CreateElement("TextButton", {
        Name = "CloseButton",
        Parent = TopBar,
        AnchorPoint = Vector2.new(1, 0),
        Position = UDim2.new(1, -10, 0, 10),
        Size = UDim2.new(0, 30, 0, 30),
        BackgroundColor3 = self.Themes[Theme].Tertiary,
        BorderSizePixel = 0,
        Text = "Ã—",
        TextColor3 = self.Themes[Theme].Text,
        TextSize = 20,
        Font = Enum.Font.GothamBold
    })

    CreateElement("UICorner", {
        Parent = CloseButton,
        CornerRadius = UDim.new(0, 6)
    })

    CloseButton.MouseButton1Click:Connect(function()
        Tween(MainFrame, {Size = UDim2.new(0, 0, 0, 0)}, 0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        task.wait(0.3)
        ScreenGui:Destroy()
    end)

    -- Tab Container
    local TabContainer = CreateElement("Frame", {
        Name = "TabContainer",
        Parent = MainFrame,
        Position = UDim2.new(0, 10, 0, 60),
        Size = UDim2.new(0, 140, 1, -70),
        BackgroundColor3 = self.Themes[Theme].Secondary,
        BorderSizePixel = 0
    })

    CreateElement("UICorner", {
        Parent = TabContainer,
        CornerRadius = UDim.new(0, 8)
    })

    local TabList = CreateElement("ScrollingFrame", {
        Name = "TabList",
        Parent = TabContainer,
        Position = UDim2.new(0, 5, 0, 5),
        Size = UDim2.new(1, -10, 1, -10),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = self.Themes[Theme].Accent,
        CanvasSize = UDim2.new(0, 0, 0, 0)
    })

    CreateElement("UIListLayout", {
        Parent = TabList,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5)
    })

    -- Content Container
    local ContentContainer = CreateElement("Frame", {
        Name = "ContentContainer",
        Parent = MainFrame,
        Position = UDim2.new(0, 160, 0, 60),
        Size = UDim2.new(1, -170, 1, -70),
        BackgroundTransparency = 1,
        BorderSizePixel = 0
    })

    -- Make draggable
    MakeDraggable(MainFrame, TopBar)

    -- Entrance animation
    MainFrame.Size = UDim2.new(0, 0, 0, 0)
    Tween(MainFrame, {Size = WindowSize}, 0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out)

    -- Window object
    local Window = {
        MainFrame = MainFrame,
        TabContainer = TabContainer,
        TabList = TabList,
        ContentContainer = ContentContainer,
        Theme = self.Themes[Theme],
        AccentColor = AccentColor,
        Tabs = {},
        CurrentTab = nil,
        Notifications = {}
    }

    -- Notification system
    function Window:Notify(options)
        options = options or {}
        local Title = options.Title or "Notification"
        local Message = options.Message or "No message provided"
        local Duration = options.Duration or 3
        local Type = options.Type or "Info"

        local NotifColor = self.Theme.Accent
        if Type == "Success" then NotifColor = self.Theme.Success
        elseif Type == "Warning" then NotifColor = self.Theme.Warning
        elseif Type == "Error" then NotifColor = self.Theme.Error
        end

        local NotifFrame = CreateElement("Frame", {
            Name = "Notification",
            Parent = ScreenGui,
            AnchorPoint = Vector2.new(1, 0),
            Position = UDim2.new(1, 20, 0, 20 + (#self.Notifications * 90)),
            Size = UDim2.new(0, 300, 0, 80),
            BackgroundColor3 = self.Theme.Secondary,
            BorderSizePixel = 0
        })

        CreateElement("UICorner", {
            Parent = NotifFrame,
            CornerRadius = UDim.new(0, 8)
        })

        CreateElement("UIStroke", {
            Parent = NotifFrame,
            Color = NotifColor,
            Thickness = 2
        })

        local NotifTitle = CreateElement("TextLabel", {
            Parent = NotifFrame,
            Position = UDim2.new(0, 15, 0, 10),
            Size = UDim2.new(1, -30, 0, 20),
            BackgroundTransparency = 1,
            Text = Title,
            TextColor3 = self.Theme.Text,
            TextSize = 14,
            Font = Enum.Font.GothamBold,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local NotifMessage = CreateElement("TextLabel", {
            Parent = NotifFrame,
            Position = UDim2.new(0, 15, 0, 35),
            Size = UDim2.new(1, -30, 0, 35),
            BackgroundTransparency = 1,
            Text = Message,
            TextColor3 = self.Theme.SubText,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextYAlignment = Enum.TextYAlignment.Top,
            TextWrapped = true
        })

        table.insert(self.Notifications, NotifFrame)

        Tween(NotifFrame, {Position = UDim2.new(1, -20, 0, 20 + ((#self.Notifications - 1) * 90))}, 0.3)

        task.delay(Duration, function()
            Tween(NotifFrame, {Position = UDim2.new(1, 20, 0, NotifFrame.Position.Y.Offset)}, 0.3)
            task.wait(0.3)
            NotifFrame:Destroy()
            for i, notif in ipairs(self.Notifications) do
                if notif == NotifFrame then
                    table.remove(self.Notifications, i)
                    break
                end
            end
            for i, notif in ipairs(self.Notifications) do
                Tween(notif, {Position = UDim2.new(1, -20, 0, 20 + ((i - 1) * 90))}, 0.2)
            end
        end)
    end

    -- Create Tab
    function Window:CreateTab(name, icon)
        icon = icon or "ðŸ“„"

        local TabButton = CreateElement("TextButton", {
            Name = name,
            Parent = self.TabList,
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundColor3 = self.Theme.Tertiary,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Text = "",
            AutoButtonColor = false
        })

        CreateElement("UICorner", {
            Parent = TabButton,
            CornerRadius = UDim.new(0, 6)
        })

        local TabIcon = CreateElement("TextLabel", {
            Parent = TabButton,
            Position = UDim2.new(0, 10, 0, 0),
            Size = UDim2.new(0, 30, 1, 0),
            BackgroundTransparency = 1,
            Text = icon,
            TextColor3 = self.Theme.SubText,
            TextSize = 16,
            Font = Enum.Font.Gotham
        })

        local TabLabel = CreateElement("TextLabel", {
            Parent = TabButton,
            Position = UDim2.new(0, 45, 0, 0),
            Size = UDim2.new(1, -50, 1, 0),
            BackgroundTransparency = 1,
            Text = name,
            TextColor3 = self.Theme.SubText,
            TextSize = 13,
            Font = Enum.Font.GothamMedium,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local TabContent = CreateElement("ScrollingFrame", {
            Name = name .. "Content",
            Parent = self.ContentContainer,
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            ScrollBarThickness = 4,
            ScrollBarImageColor3 = self.AccentColor,
            CanvasSize = UDim2.new(0, 0, 0, 0),
            Visible = false
        })

        CreateElement("UIListLayout", {
            Parent = TabContent,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 8)
        })

        CreateElement("UIPadding", {
            Parent = TabContent,
            PaddingTop = UDim.new(0, 5),
            PaddingLeft = UDim.new(0, 5),
            PaddingRight = UDim.new(0, 5),
            PaddingBottom = UDim.new(0, 5)
        })

        -- Update canvas size
        TabContent.ChildAdded:Connect(function()
            task.wait()
            local contentSize = TabContent.UIListLayout.AbsoluteContentSize
            TabContent.CanvasSize = UDim2.new(0, 0, 0, contentSize.Y + 10)
        end)

        local Tab = {
            Button = TabButton,
            Content = TabContent,
            Name = name,
            Window = self,
            Elements = {}
        }

        TabButton.MouseButton1Click:Connect(function()
            for _, tab in pairs(self.Tabs) do
                tab.Content.Visible = false
                Tween(tab.Button, {BackgroundTransparency = 1}, 0.2)
                tab.Button.TextLabel.TextColor3 = self.Theme.SubText
                tab.Button.TextLabel.Font = Enum.Font.GothamMedium
            end

            TabContent.Visible = true
            Tween(TabButton, {BackgroundTransparency = 0, BackgroundColor3 = self.Theme.Tertiary}, 0.2)
            TabLabel.TextColor3 = self.AccentColor
            TabLabel.Font = Enum.Font.GothamBold
            self.CurrentTab = Tab
        end)

        TabButton.MouseEnter:Connect(function()
            if self.CurrentTab ~= Tab then
                Tween(TabButton, {BackgroundTransparency = 0.5, BackgroundColor3 = self.Theme.Tertiary}, 0.2)
            end
        end)

        TabButton.MouseLeave:Connect(function()
            if self.CurrentTab ~= Tab then
                Tween(TabButton, {BackgroundTransparency = 1}, 0.2)
            end
        end)

        table.insert(self.Tabs, Tab)

        if not self.CurrentTab then
            TabButton.MouseButton1Click:Fire()
        end

        -- Add Section
        function Tab:AddSection(name)
            local SectionFrame = CreateElement("Frame", {
                Name = "Section_" .. name,
                Parent = self.Content,
                Size = UDim2.new(1, 0, 0, 35),
                BackgroundTransparency = 1,
                BorderSizePixel = 0
            })

            local SectionLabel = CreateElement("TextLabel", {
                Parent = SectionFrame,
                Position = UDim2.new(0, 5, 0, 5),
                Size = UDim2.new(1, -10, 1, -5),
                BackgroundTransparency = 1,
                Text = name,
                TextColor3 = self.Window.Theme.Text,
                TextSize = 14,
                Font = Enum.Font.GothamBold,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Top
            })

            local Divider = CreateElement("Frame", {
                Parent = SectionFrame,
                Position = UDim2.new(0, 0, 1, -1),
                Size = UDim2.new(1, 0, 0, 1),
                BackgroundColor3 = self.Window.Theme.Border,
                BorderSizePixel = 0
            })

            return SectionFrame
        end

        -- Add Button
        function Tab:AddButton(name, callback)
            callback = callback or function() end

            local ButtonFrame = CreateElement("Frame", {
                Name = "Button_" .. name,
                Parent = self.Content,
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundColor3 = self.Window.Theme.Secondary,
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = ButtonFrame,
                CornerRadius = UDim.new(0, 6)
            })

            CreateElement("UIStroke", {
                Parent = ButtonFrame,
                Color = self.Window.Theme.Border,
                Transparency = 0.7,
                Thickness = 1
            })

            local Button = CreateElement("TextButton", {
                Parent = ButtonFrame,
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = "",
                AutoButtonColor = false
            })

            local ButtonLabel = CreateElement("TextLabel", {
                Parent = Button,
                Position = UDim2.new(0, 15, 0, 0),
                Size = UDim2.new(1, -30, 1, 0),
                BackgroundTransparency = 1,
                Text = name,
                TextColor3 = self.Window.Theme.Text,
                TextSize = 13,
                Font = Enum.Font.Gotham,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            Button.MouseButton1Click:Connect(function()
                Tween(ButtonFrame, {BackgroundColor3 = self.Window.AccentColor}, 0.1)
                task.wait(0.1)
                Tween(ButtonFrame, {BackgroundColor3 = self.Window.Theme.Secondary}, 0.1)
                callback()
            end)

            Button.MouseEnter:Connect(function()
                Tween(ButtonFrame, {BackgroundColor3 = self.Window.Theme.Tertiary}, 0.2)
            end)

            Button.MouseLeave:Connect(function()
                Tween(ButtonFrame, {BackgroundColor3 = self.Window.Theme.Secondary}, 0.2)
            end)

            return Button
        end

        -- Add Toggle
        function Tab:AddToggle(name, default, callback)
            default = default or false
            callback = callback or function() end

            local ToggleFrame = CreateElement("Frame", {
                Name = "Toggle_" .. name,
                Parent = self.Content,
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundColor3 = self.Window.Theme.Secondary,
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = ToggleFrame,
                CornerRadius = UDim.new(0, 6)
            })

            CreateElement("UIStroke", {
                Parent = ToggleFrame,
                Color = self.Window.Theme.Border,
                Transparency = 0.7,
                Thickness = 1
            })

            local ToggleLabel = CreateElement("TextLabel", {
                Parent = ToggleFrame,
                Position = UDim2.new(0, 15, 0, 0),
                Size = UDim2.new(1, -70, 1, 0),
                BackgroundTransparency = 1,
                Text = name,
                TextColor3 = self.Window.Theme.Text,
                TextSize = 13,
                Font = Enum.Font.Gotham,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local ToggleButton = CreateElement("TextButton", {
                Parent = ToggleFrame,
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, -15, 0.5, 0),
                Size = UDim2.new(0, 45, 0, 22),
                BackgroundColor3 = default and self.Window.AccentColor or self.Window.Theme.Tertiary,
                BorderSizePixel = 0,
                Text = "",
                AutoButtonColor = false
            })

            CreateElement("UICorner", {
                Parent = ToggleButton,
                CornerRadius = UDim.new(1, 0)
            })

            local ToggleCircle = CreateElement("Frame", {
                Parent = ToggleButton,
                Position = default and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0),
                Size = UDim2.new(0, 18, 0, 18),
                AnchorPoint = Vector2.new(0, 0.5),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = ToggleCircle,
                CornerRadius = UDim.new(1, 0)
            })

            local toggled = default

            ToggleButton.MouseButton1Click:Connect(function()
                toggled = not toggled
                Tween(ToggleButton, {BackgroundColor3 = toggled and self.Window.AccentColor or self.Window.Theme.Tertiary}, 0.2)
                Tween(ToggleCircle, {Position = toggled and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0)}, 0.2)
                callback(toggled)
            end)

            local Toggle = {}
            function Toggle:SetValue(value)
                toggled = value
                Tween(ToggleButton, {BackgroundColor3 = toggled and self.Window.AccentColor or self.Window.Theme.Tertiary}, 0.2)
                Tween(ToggleCircle, {Position = toggled and UDim2.new(1, -20, 0.5, 0) or UDim2.new(0, 2, 0.5, 0)}, 0.2)
                callback(toggled)
            end

            function Toggle:GetValue()
                return toggled
            end

            return Toggle
        end

        -- Add Slider
        function Tab:AddSlider(name, min, max, default, callback)
            min = min or 0
            max = max or 100
            default = default or min
            callback = callback or function() end

            local SliderFrame = CreateElement("Frame", {
                Name = "Slider_" .. name,
                Parent = self.Content,
                Size = UDim2.new(1, 0, 0, 55),
                BackgroundColor3 = self.Window.Theme.Secondary,
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = SliderFrame,
                CornerRadius = UDim.new(0, 6)
            })

            CreateElement("UIStroke", {
                Parent = SliderFrame,
                Color = self.Window.Theme.Border,
                Transparency = 0.7,
                Thickness = 1
            })

            local SliderLabel = CreateElement("TextLabel", {
                Parent = SliderFrame,
                Position = UDim2.new(0, 15, 0, 8),
                Size = UDim2.new(1, -30, 0, 16),
                BackgroundTransparency = 1,
                Text = name,
                TextColor3 = self.Window.Theme.Text,
                TextSize = 13,
                Font = Enum.Font.Gotham,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local SliderValue = CreateElement("TextLabel", {
                Parent = SliderFrame,
                Position = UDim2.new(1, -15, 0, 8),
                Size = UDim2.new(0, 40, 0, 16),
                AnchorPoint = Vector2.new(1, 0),
                BackgroundTransparency = 1,
                Text = tostring(default),
                TextColor3 = self.Window.AccentColor,
                TextSize = 13,
                Font = Enum.Font.GothamBold,
                TextXAlignment = Enum.TextXAlignment.Right
            })

            local SliderBack = CreateElement("Frame", {
                Parent = SliderFrame,
                Position = UDim2.new(0, 15, 0, 35),
                Size = UDim2.new(1, -30, 0, 6),
                BackgroundColor3 = self.Window.Theme.Tertiary,
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = SliderBack,
                CornerRadius = UDim.new(1, 0)
            })

            local SliderFill = CreateElement("Frame", {
                Parent = SliderBack,
                Size = UDim2.new((default - min) / (max - min), 0, 1, 0),
                BackgroundColor3 = self.Window.AccentColor,
                BorderSizePixel = 0
            })

            CreateElement("UICorner", {
                Parent = SliderFill,
                CornerRadius = UDim.new(1, 0)
            })

            local dragging = false

            local function updateSlider(input)
                local pos = math.clamp((input.Position.X - SliderBack.AbsolutePosition.X) / SliderBack.AbsoluteSize.X, 0, 1)
                local value = math.floor(min + (max - min) * pos)
                SliderFill.Size = UDim2.new(pos, 0, 1, 0)
                SliderValue.Text = tostring(value)
                callback(value)
            end

            SliderBack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = true
                    updateSlider(input)
                end
            end)

            SliderBack.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
dragging = false
end
end)

UserInputService.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                updateSlider(input)
            end
        end)

        local Slider = {}
        function Slider:SetValue(value)
            value = math.clamp(value, min, max)
            local pos = (value - min) / (max - min)
            SliderFill.Size = UDim2.new(pos, 0, 1, 0)
            SliderValue.Text = tostring(value)
            callback(value)
        end

        function Slider:GetValue()
            return tonumber(SliderValue.Text)
        end

        return Slider
    end

    -- Add Dropdown
    function Tab:AddDropdown(name, options, callback)
        options = options or {}
        callback = callback or function() end

        local DropdownFrame = CreateElement("Frame", {
            Name = "Dropdown_" .. name,
            Parent = self.Content,
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundColor3 = self.Window.Theme.Secondary,
            BorderSizePixel = 0,
            ClipsDescendants = false
        })

        CreateElement("UICorner", {
            Parent = DropdownFrame,
            CornerRadius = UDim.new(0, 6)
        })

        CreateElement("UIStroke", {
            Parent = DropdownFrame,
            Color = self.Window.Theme.Border,
            Transparency = 0.7,
            Thickness = 1
        })

        local DropdownLabel = CreateElement("TextLabel", {
            Parent = DropdownFrame,
            Position = UDim2.new(0, 15, 0, 0),
            Size = UDim2.new(1, -70, 1, 0),
            BackgroundTransparency = 1,
            Text = name,
            TextColor3 = self.Window.Theme.Text,
            TextSize = 13,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local DropdownButton = CreateElement("TextButton", {
            Parent = DropdownFrame,
            AnchorPoint = Vector2.new(1, 0.5),
            Position = UDim2.new(1, -15, 0.5, 0),
            Size = UDim2.new(0, 80, 0, 28),
            BackgroundColor3 = self.Window.Theme.Tertiary,
            BorderSizePixel = 0,
            Text = options[1] or "None",
            TextColor3 = self.Window.Theme.Text,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            AutoButtonColor = false
        })

        CreateElement("UICorner", {
            Parent = DropdownButton,
            CornerRadius = UDim.new(0, 5)
        })

        local DropdownList = CreateElement("Frame", {
            Name = "DropdownList",
            Parent = DropdownFrame,
            Position = UDim2.new(0, 0, 1, 5),
            Size = UDim2.new(1, 0, 0, 0),
            BackgroundColor3 = self.Window.Theme.Secondary,
            BorderSizePixel = 0,
            ClipsDescendants = true,
            Visible = false,
            ZIndex = 10
        })

        CreateElement("UICorner", {
            Parent = DropdownList,
            CornerRadius = UDim.new(0, 6)
        })

        CreateElement("UIStroke", {
            Parent = DropdownList,
            Color = self.Window.Theme.Border,
            Transparency = 0.7,
            Thickness = 1
        })

        CreateElement("UIListLayout", {
            Parent = DropdownList,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 2)
        })

        CreateElement("UIPadding", {
            Parent = DropdownList,
            PaddingTop = UDim.new(0, 5),
            PaddingBottom = UDim.new(0, 5),
            PaddingLeft = UDim.new(0, 5),
            PaddingRight = UDim.new(0, 5)
        })

        local expanded = false
        local selectedOption = options[1] or "None"

        DropdownButton.MouseButton1Click:Connect(function()
            expanded = not expanded
            DropdownList.Visible = expanded
            if expanded then
                Tween(DropdownList, {Size = UDim2.new(1, 0, 0, math.min(#options * 32 + 10, 150))}, 0.2)
            else
                Tween(DropdownList, {Size = UDim2.new(1, 0, 0, 0)}, 0.2)
            end
        end)

        for _, option in ipairs(options) do
            local OptionButton = CreateElement("TextButton", {
                Parent = DropdownList,
                Size = UDim2.new(1, -10, 0, 28),
                BackgroundColor3 = self.Window.Theme.Tertiary,
                BackgroundTransparency = 1,
                BorderSizePixel = 0,
                Text = option,
                TextColor3 = self.Window.Theme.Text,
                TextSize = 12,
                Font = Enum.Font.Gotham,
                AutoButtonColor = false
            })

            CreateElement("UICorner", {
                Parent = OptionButton,
                CornerRadius = UDim.new(0, 4)
            })

            OptionButton.MouseButton1Click:Connect(function()
                selectedOption = option
                DropdownButton.Text = option
                expanded = false
                Tween(DropdownList, {Size = UDim2.new(1, 0, 0, 0)}, 0.2)
                task.wait(0.2)
                DropdownList.Visible = false
                callback(option)
            end)

            OptionButton.MouseEnter:Connect(function()
                Tween(OptionButton, {BackgroundTransparency = 0}, 0.1)
            end)

            OptionButton.MouseLeave:Connect(function()
                Tween(OptionButton, {BackgroundTransparency = 1}, 0.1)
            end)
        end

        local Dropdown = {}
        function Dropdown:SetValue(value)
            if table.find(options, value) then
                selectedOption = value
                DropdownButton.Text = value
                callback(value)
            end
        end

        function Dropdown:GetValue()
            return selectedOption
        end

        return Dropdown
    end

    -- Add TextBox
    function Tab:AddTextBox(name, placeholder, callback)
        placeholder = placeholder or "Enter text..."
        callback = callback or function() end

        local TextBoxFrame = CreateElement("Frame", {
            Name = "TextBox_" .. name,
            Parent = self.Content,
            Size = UDim2.new(1, 0, 0, 65),
            BackgroundColor3 = self.Window.Theme.Secondary,
            BorderSizePixel = 0
        })

        CreateElement("UICorner", {
            Parent = TextBoxFrame,
            CornerRadius = UDim.new(0, 6)
        })

        CreateElement("UIStroke", {
            Parent = TextBoxFrame,
            Color = self.Window.Theme.Border,
            Transparency = 0.7,
            Thickness = 1
        })

        local TextBoxLabel = CreateElement("TextLabel", {
            Parent = TextBoxFrame,
            Position = UDim2.new(0, 15, 0, 8),
            Size = UDim2.new(1, -30, 0, 16),
            BackgroundTransparency = 1,
            Text = name,
            TextColor3 = self.Window.Theme.Text,
            TextSize = 13,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local TextBox = CreateElement("TextBox", {
            Parent = TextBoxFrame,
            Position = UDim2.new(0, 15, 0, 30),
            Size = UDim2.new(1, -30, 0, 28),
            BackgroundColor3 = self.Window.Theme.Tertiary,
            BorderSizePixel = 0,
            PlaceholderText = placeholder,
            PlaceholderColor3 = self.Window.Theme.SubText,
            Text = "",
            TextColor3 = self.Window.Theme.Text,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            ClearTextOnFocus = false
        })

        CreateElement("UICorner", {
            Parent = TextBox,
            CornerRadius = UDim.new(0, 5)
        })

        CreateElement("UIPadding", {
            Parent = TextBox,
            PaddingLeft = UDim.new(0, 10),
            PaddingRight = UDim.new(0, 10)
        })

        TextBox.FocusLost:Connect(function(enterPressed)
            if enterPressed then
                callback(TextBox.Text)
            end
        end)

        local TextBoxObj = {}
        function TextBoxObj:SetValue(value)
            TextBox.Text = value
        end

        function TextBoxObj:GetValue()
            return TextBox.Text
        end

        return TextBoxObj
    end

    -- Add Label
    function Tab:AddLabel(text)
        local LabelFrame = CreateElement("Frame", {
            Name = "Label",
            Parent = self.Content,
            Size = UDim2.new(1, 0, 0, 30),
            BackgroundTransparency = 1,
            BorderSizePixel = 0
        })

        local Label = CreateElement("TextLabel", {
            Parent = LabelFrame,
            Position = UDim2.new(0, 5, 0, 0),
            Size = UDim2.new(1, -10, 1, 0),
            BackgroundTransparency = 1,
            Text = text,
            TextColor3 = self.Window.Theme.SubText,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true
        })

        local LabelObj = {}
        function LabelObj:SetText(newText)
            Label.Text = newText
        end

        return LabelObj
    end

    -- Add Keybind
    function Tab:AddKeybind(name, default, callback)
        default = default or Enum.KeyCode.E
        callback = callback or function() end

        local KeybindFrame = CreateElement("Frame", {
            Name = "Keybind_" .. name,
            Parent = self.Content,
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundColor3 = self.Window.Theme.Secondary,
            BorderSizePixel = 0
        })

        CreateElement("UICorner", {
            Parent = KeybindFrame,
            CornerRadius = UDim.new(0, 6)
        })

        CreateElement("UIStroke", {
            Parent = KeybindFrame,
            Color = self.Window.Theme.Border,
            Transparency = 0.7,
            Thickness = 1
        })

        local KeybindLabel = CreateElement("TextLabel", {
            Parent = KeybindFrame,
            Position = UDim2.new(0, 15, 0, 0),
            Size = UDim2.new(1, -100, 1, 0),
            BackgroundTransparency = 1,
            Text = name,
            TextColor3 = self.Window.Theme.Text,
            TextSize = 13,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local KeybindButton = CreateElement("TextButton", {
            Parent = KeybindFrame,
            AnchorPoint = Vector2.new(1, 0.5),
            Position = UDim2.new(1, -15, 0.5, 0),
            Size = UDim2.new(0, 70, 0, 28),
            BackgroundColor3 = self.Window.Theme.Tertiary,
            BorderSizePixel = 0,
            Text = default.Name,
            TextColor3 = self.Window.Theme.Text,
            TextSize = 12,
            Font = Enum.Font.GothamBold,
            AutoButtonColor = false
        })

        CreateElement("UICorner", {
            Parent = KeybindButton,
            CornerRadius = UDim.new(0, 5)
        })

        local currentKey = default
        local binding = false

        KeybindButton.MouseButton1Click:Connect(function()
            binding = true
            KeybindButton.Text = "..."
            KeybindButton.TextColor3 = self.Window.AccentColor
        end)

        UserInputService.InputBegan:Connect(function(input, gameProcessed)
            if binding and input.UserInputType == Enum.UserInputType.Keyboard then
                currentKey = input.KeyCode
                KeybindButton.Text = input.KeyCode.Name
                KeybindButton.TextColor3 = self.Window.Theme.Text
                binding = false
            elseif not gameProcessed and input.KeyCode == currentKey then
                callback()
            end
        end)

        local Keybind = {}
        function Keybind:SetValue(key)
            currentKey = key
            KeybindButton.Text = key.Name
        end

        function Keybind:GetValue()
            return currentKey
        end

        return Keybind
    end

    return Tab
end

return Window
end
return Library
