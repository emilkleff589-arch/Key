--[[ 
    SHARKY HUB | RAYFIELD EDITION (V6.0)
    
    [RAYFIELD FEATURES ADAPTED]
    - Segmented Layout: Topbar, Sidebar, and Elements separated.
    - Component Strokes: Rayfield-style "ElementStroke" (Color3.fromRGB(50, 50, 50)).
    - Interaction: Tab buttons with the signature Rayfield "Selection" glow.
    - Full Logic: Omni-dragging and Edge-resizing preserved.
]]

local Library = {
    Theme = {
        Background = Color3.fromRGB(25, 25, 25),
        Topbar = Color3.fromRGB(34, 34, 34),
        Sidebar = Color3.fromRGB(30, 30, 30),
        Accent = Color3.fromRGB(0, 146, 214), -- Rayfield Blue
        ElementStroke = Color3.fromRGB(50, 50, 50),
        Text = Color3.fromRGB(240, 240, 240),
        SubText = Color3.fromRGB(178, 178, 178)
    }
}

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local Viewport = (gethui and gethui()) or CoreGui

local function QuickTween(obj, props, time)
    TweenService:Create(obj, TweenInfo.new(time or 0.3, Enum.EasingStyle.Quint), props):Play()
end

function Library:CreateWindow()
    local ScreenGui = Instance.new("ScreenGui", Viewport)
    ScreenGui.Name = "Sharky_Rayfield_Edition"
    
    --// MAIN FRAME
    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.new(0, 600, 0, 450)
    Main.Position = UDim2.new(0.5, -300, 0.5, -225)
    Main.BackgroundColor3 = Library.Theme.Background
    Main.BorderSizePixel = 0
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 8)

    -- Top Shadow / Stroke
    local MainStroke = Instance.new("UIStroke", Main)
    MainStroke.Color = Library.Theme.ElementStroke
    MainStroke.Thickness = 1

    --// RAYFIELD TOPBAR
    local Topbar = Instance.new("Frame", Main)
    Topbar.Size = UDim2.new(1, 0, 0, 45)
    Topbar.BackgroundColor3 = Library.Theme.Topbar
    Topbar.BorderSizePixel = 0
    local TopCorner = Instance.new("UICorner", Topbar)
    TopCorner.CornerRadius = UDim.new(0, 8)
    
    -- "Repair" corner (hides rounded bottom of topbar)
    local Repair = Instance.new("Frame", Topbar)
    Repair.Size = UDim2.new(1, 0, 0, 10)
    Repair.Position = UDim2.new(0, 0, 1, -10)
    Repair.BackgroundColor3 = Library.Theme.Topbar
    Repair.BorderSizePixel = 0

    local HubTitle = Instance.new("TextLabel", Topbar)
    HubTitle.Text = "Sharky | v.1.0"
    HubTitle.Size = UDim2.new(0, 200, 1, 0)
    HubTitle.Position = UDim2.new(0, 15, 0, 0)
    HubTitle.Font = Enum.Font.GothamMedium
    HubTitle.TextColor3 = Library.Theme.Text
    HubTitle.TextSize = 15
    HubTitle.TextXAlignment = Enum.TextXAlignment.Left
    HubTitle.BackgroundTransparency = 1

    --// SIDEBAR & CONTENT AREA
    local Container = Instance.new("Frame", Main)
    Container.Size = UDim2.new(1, 0, 1, -45)
    Container.Position = UDim2.new(0, 0, 0, 45)
    Container.BackgroundTransparency = 1

    local Sidebar = Instance.new("Frame", Container)
    Sidebar.Size = UDim2.new(0, 160, 1, 0)
    Sidebar.BackgroundColor3 = Library.Theme.Sidebar
    Sidebar.BorderSizePixel = 0

    local SideStroke = Instance.new("Frame", Sidebar)
    SideStroke.Size = UDim2.new(0, 1, 1, 0)
    SideStroke.Position = UDim2.new(1, 0, 0, 0)
    SideStroke.BackgroundColor3 = Library.Theme.ElementStroke
    SideStroke.BorderSizePixel = 0

    local TabHolder = Instance.new("ScrollingFrame", Sidebar)
    TabHolder.Size = UDim2.new(1, -10, 1, -20)
    TabHolder.Position = UDim2.new(0, 5, 0, 10)
    TabHolder.BackgroundTransparency = 1
    TabHolder.ScrollBarThickness = 0
    local TabListLayout = Instance.new("UIListLayout", TabHolder)
    TabListLayout.Padding = UDim.new(0, 5)

    local Content = Instance.new("Frame", Container)
    Content.Size = UDim2.new(1, -170, 1, -10)
    Content.Position = UDim2.new(0, 170, 0, 5)
    Content.BackgroundTransparency = 1

    --// DRAG & RESIZE
    local dragging, resizing, dragStart, startPos, resStart, resSize
    
    Topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = Main.Position
        end
    end)

    Main.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local mousePos = UserInputService:GetMouseLocation()
            local framePos = Main.AbsolutePosition
            local frameSize = Main.AbsoluteSize
            if (framePos.X + frameSize.X - mousePos.X) < 20 and (framePos.Y + frameSize.Y - mousePos.Y) < 20 then
                resizing = true; resStart = input.Position; resSize = Main.Size
            end
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        elseif resizing and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - resStart
            Main.Size = UDim2.new(0, math.clamp(resSize.X.Offset + delta.X, 450, 1000), 0, math.clamp(resSize.Y.Offset + delta.Y, 300, 700))
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false; resizing = false
        end
    end)

    local Window = {}
    local Tabs = {}
    local firstTab = true

    function Window:CreateTab(tName)
        local isHome = firstTab
        firstTab = false
        local finalName = isHome and "Home" or tName

        local TabBtn = Instance.new("TextButton", TabHolder)
        TabBtn.Size = UDim2.new(1, 0, 0, 32)
        TabBtn.BackgroundColor3 = Library.Theme.Accent
        TabBtn.BackgroundTransparency = 1
        TabBtn.Text = ""
        TabBtn.AutoButtonColor = false
        Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)

        local TText = Instance.new("TextLabel", TabBtn)
        TText.Text = finalName
        TText.Size = UDim2.new(1, 0, 1, 0)
        TText.Font = Enum.Font.GothamMedium
        TText.TextColor3 = Library.Theme.SubText
        TText.TextSize = 13
        TText.BackgroundTransparency = 1

        local Page = Instance.new("ScrollingFrame", Content)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.Visible = false
        Page.BackgroundTransparency = 1
        Page.ScrollBarThickness = 2
        Instance.new("UIListLayout", Page).Padding = UDim.new(0, 8)

        local function Select()
            for _, v in pairs(Tabs) do
                v.Page.Visible = false
                QuickTween(v.Btn, {BackgroundTransparency = 1})
                QuickTween(v.Text, {TextColor3 = Library.Theme.SubText})
            end
            Page.Visible = true
            QuickTween(TabBtn, {BackgroundTransparency = 0.85})
            QuickTween(TText, {TextColor3 = Library.Theme.Text})
        end

        TabBtn.MouseButton1Click:Connect(Select)
        table.insert(Tabs, {Btn = TabBtn, Page = Page, Text = TText})

        if isHome then Select() end
        return {}
    end

    return Window
end

return Library
