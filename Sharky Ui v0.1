--[[ 
    SHARKY HUB | OBSIDIAN PRISM (PREMIUM EDITION)
    
    [DESIGN ARCHITECTURE]
    - Layered Shadows: Uses offset frames with high blur (Transparency 0.85).
    - Specular Edges: 1.2px UIStroke with a white-to-transparent gradient.
    - Button Gloss: Subtle inner-glow gradients and top-highlighting.
    - Motion: Quintic easing for hover states and tab transitions.
]]

local Library = {
    Theme = {
        Background = Color3.fromRGB(15, 15, 17),
        Sidebar = Color3.fromRGB(20, 20, 23),
        Accent = Color3.fromRGB(0, 160, 255),
        AccentGlow = Color3.fromRGB(0, 100, 255),
        Stroke = Color3.fromRGB(45, 45, 50),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(160, 160, 165),
    }
}

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Viewport = (gethui and gethui()) or game:GetService("CoreGui")

local function QuickTween(obj, props, time)
    TweenService:Create(obj, TweenInfo.new(time or 0.35, Enum.EasingStyle.Quint), props):Play()
end

function Library:CreateWindow()
    local ScreenGui = Instance.new("ScreenGui", Viewport)
    ScreenGui.Name = "ObsidianPrism_Sharky"
    
    --// SHADOW LAYER
    local Shadow = Instance.new("Frame", ScreenGui)
    Shadow.Size = UDim2.new(0, 610, 0, 410)
    Shadow.Position = UDim2.new(0.5, -305, 0.5, -200)
    Shadow.BackgroundColor3 = Color3.new(0,0,0)
    Shadow.BackgroundTransparency = 0.8
    Shadow.BorderSizePixel = 0
    Instance.new("UICorner", Shadow).CornerRadius = UDim.new(0, 14)

    --// MAIN FRAME
    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.new(0, 600, 0, 400)
    Main.Position = UDim2.new(0.5, -300, 0.5, -200)
    Main.BackgroundColor3 = Library.Theme.Background
    Main.ClipsDescendants = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 12)

    -- Glossy Specular Stroke
    local SpecularStroke = Instance.new("UIStroke", Main)
    SpecularStroke.Thickness = 1.2
    local SGrad = Instance.new("UIGradient", SpecularStroke)
    SGrad.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.new(1,1,1)), -- Bright corner
        ColorSequenceKeypoint.new(0.5, Library.Theme.Stroke),
        ColorSequenceKeypoint.new(1, Color3.new(0.1, 0.1, 0.1))
    })
    SGrad.Rotation = 45

    --// SIDEBAR
    local Sidebar = Instance.new("Frame", Main)
    Sidebar.Size = UDim2.new(0, 170, 1, 0)
    Sidebar.BackgroundColor3 = Library.Theme.Sidebar
    Sidebar.BorderSizePixel = 0
    
    local HubLabel = Instance.new("TextLabel", Sidebar)
    HubLabel.Text = "SHARKY"
    HubLabel.Size = UDim2.new(1, 0, 0, 60)
    HubLabel.Font = Enum.Font.GothamBold
    HubLabel.TextColor3 = Library.Theme.Text
    HubLabel.TextSize = 18
    HubLabel.BackgroundTransparency = 1
    HubLabel.TextXAlignment = Enum.TextXAlignment.Center

    local TabHolder = Instance.new("ScrollingFrame", Sidebar)
    TabHolder.Size = UDim2.new(1, -20, 1, -70)
    TabHolder.Position = UDim2.new(0, 10, 0, 60)
    TabHolder.BackgroundTransparency = 1
    TabHolder.ScrollBarThickness = 0
    local TabList = Instance.new("UIListLayout", TabHolder)
    TabList.Padding = UDim.new(0, 8)

    --// CONTENT
    local Content = Instance.new("Frame", Main)
    Content.Size = UDim2.new(1, -190, 1, -20)
    Content.Position = UDim2.new(0, 180, 0, 10)
    Content.BackgroundTransparency = 1

    --// DRAGGABLE LOGIC
    local dragging, dragStart, startPos
    Main.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = Main.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            local newPos = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            Main.Position = newPos
            Shadow.Position = UDim2.new(newPos.X.Scale, newPos.X.Offset - 5, newPos.Y.Scale, newPos.Y.Offset + 5)
        end
    end)

    local Window = {}
    local Tabs = {}
    local firstTab = true

    function Window:CreateTab(tName)
        local TabBtn = Instance.new("TextButton", TabHolder)
        TabBtn.Size = UDim2.new(1, 0, 0, 38)
        TabBtn.BackgroundColor3 = Library.Theme.Accent
        TabBtn.BackgroundTransparency = 1
        TabBtn.Text = ""
        TabBtn.AutoButtonColor = false
        Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 8)

        local TText = Instance.new("TextLabel", TabBtn)
        TText.Text = tName
        TText.Size = UDim2.new(1, 0, 1, 0)
        TText.Font = Enum.Font.GothamMedium
        TText.TextColor3 = Library.Theme.SubText
        TText.TextSize = 13
        TText.BackgroundTransparency = 1

        -- Inner Gloss Gradient for Button
        local BtnGrad = Instance.new("UIGradient", TabBtn)
        BtnGrad.Color = ColorSequence.new(Color3.new(1,1,1), Library.Theme.Accent)
        BtnGrad.Rotation = 90
        BtnGrad.Enabled = false

        local Page = Instance.new("CanvasGroup", Content)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.Visible = false
        Page.BackgroundTransparency = 1

        local function Select()
            for _, v in pairs(Tabs) do
                v.Page.Visible = false
                QuickTween(v.Btn, {BackgroundTransparency = 1})
                QuickTween(v.Text, {TextColor3 = Library.Theme.SubText})
                v.Grad.Enabled = false
            end
            Page.Visible = true
            Page.GroupTransparency = 1
            QuickTween(Page, {GroupTransparency = 0}, 0.5)
            QuickTween(TabBtn, {BackgroundTransparency = 0.15})
            QuickTween(TText, {TextColor3 = Library.Theme.Text})
            BtnGrad.Enabled = true
        end

        TabBtn.MouseEnter:Connect(function()
            if not Page.Visible then QuickTween(TText, {TextColor3 = Library.Theme.Text}) end
        end)
        TabBtn.MouseLeave:Connect(function()
            if not Page.Visible then QuickTween(TText, {TextColor3 = Library.Theme.SubText}) end
        end)
        TabBtn.MouseButton1Click:Connect(Select)

        table.insert(Tabs, {Btn = TabBtn, Page = Page, Text = TText, Grad = BtnGrad})
        if firstTab then firstTab = false; Select() end

        return {
            AddButton = function(_, text, callback)
                local b = Instance.new("TextButton", Page)
                b.Size = UDim2.new(1, 0, 0, 40)
                b.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
                b.Text = text
                b.Font = Enum.Font.GothamMedium
                b.TextColor3 = Color3.new(1,1,1)
                b.TextSize = 14
                Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
                Instance.new("UIStroke", b).Color = Library.Theme.Stroke
                
                b.MouseButton1Click:Connect(callback)
            end
        }
    end

    return Window
end

return Library
