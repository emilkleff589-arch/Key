--[[ 
    TITANIUM UI LIBRARY | HOME REFINEMENT (V2.8.0)
    
    [CHANGELOG]
    - Dedicated "Home" Tab integration with Lucide Icon.
    - Zero-Alpha Text Backgrounds (Fully Invisible).
    - Refined Sidebar padding for a "Cleaner" look.
    - Specular Light "Glass" Stroke on all components.
    - Ultra-Smooth Tab switching with Staggered Slide.
]]

local Library = {
    Theme = {
        Main = Color3.fromRGB(10, 10, 10),
        Sidebar = Color3.fromRGB(15, 15, 15),
        Accent = Color3.fromRGB(0, 160, 255),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(160, 160, 160),
        Stroke = Color3.fromRGB(60, 60, 60),
        -- Lucide Mappings
        Icons = {
            ["home"] = "rbxassetid://10723345518",
            ["settings"] = "rbxassetid://10709819149",
            ["user"] = "rbxassetid://10709810310",
            ["zap"] = "rbxassetid://10705034321"
        }
    }
}

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local Viewport = (gethui and gethui()) or CoreGui

local function QuickTween(obj, props, time)
    TweenService:Create(obj, TweenInfo.new(time or 0.4, Enum.EasingStyle.Quint), props):Play()
end

function Library:CreateWindow(cfg)
    local ScreenGui = Instance.new("ScreenGui", Viewport)
    ScreenGui.Name = "Titanium_Home_Edition"
    
    --// MAIN FRAME (0.08 GLASS)
    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.new(0, 660, 0, 440)
    Main.Position = UDim2.new(0.5, -330, 0.5, -220)
    Main.BackgroundColor3 = Library.Theme.Main
    Main.BackgroundTransparency = 0.08
    
    local MainCorner = Instance.new("UICorner", Main)
    MainCorner.CornerRadius = UDim.new(0, 10)

    -- Specular Glossy Stroke
    local MainStroke = Instance.new("UIStroke", Main)
    MainStroke.Thickness = 1
    MainStroke.Color = Color3.new(1,1,1)
    local MStrokeGrad = Instance.new("UIGradient", MainStroke)
    MStrokeGrad.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(0.4, Library.Theme.Stroke),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 30, 30))
    })
    MStrokeGrad.Rotation = 45

    --// TOPBAR (DRAG AREA)
    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1, 0, 0, 40)
    TopBar.BackgroundTransparency = 1

    local Title = Instance.new("TextLabel", TopBar)
    Title.Text = cfg.Name or "TITANIUM"
    Title.Size = UDim2.new(1, -40, 1, 0)
    Title.Position = UDim2.new(0, 20, 0, 0)
    Title.Font = Enum.Font.GothamBold
    Title.TextColor3 = Library.Theme.Text
    Title.TextSize = 14
    Title.BackgroundTransparency = 1 -- INVISIBLE AS REQUESTED
    Title.TextXAlignment = Enum.TextXAlignment.Left

    --// SIDEBAR
    local Sidebar = Instance.new("Frame", Main)
    Sidebar.Size = UDim2.new(0, 160, 1, -60)
    Sidebar.Position = UDim2.new(0, 12, 0, 50)
    Sidebar.BackgroundColor3 = Library.Theme.Sidebar
    Sidebar.BackgroundTransparency = 0.5
    Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 8)

    local TabHolder = Instance.new("ScrollingFrame", Sidebar)
    TabHolder.Size = UDim2.new(1, 0, 1, -10)
    TabHolder.Position = UDim2.new(0, 0, 0, 5)
    TabHolder.BackgroundTransparency = 1
    TabHolder.ScrollBarThickness = 0
    
    local TabList = Instance.new("UIListLayout", TabHolder)
    TabList.Padding = UDim.new(0, 4)
    Instance.new("UIPadding", TabHolder).PaddingLeft = UDim.new(0, 8)
    Instance.new("UIPadding", TabHolder).PaddingRight = UDim.new(0, 8)

    --// CONTENT
    local Content = Instance.new("Frame", Main)
    Content.Size = UDim2.new(1, -195, 1, -60)
    Content.Position = UDim2.new(0, 185, 0, 50)
    Content.BackgroundTransparency = 1

    --// RESIZE HANDLE
    local ResizeBtn = Instance.new("ImageButton", Main)
    ResizeBtn.Size = UDim2.new(0, 14, 0, 14)
    ResizeBtn.Position = UDim2.new(1, -14, 1, -14)
    ResizeBtn.BackgroundTransparency = 1
    ResizeBtn.Image = "rbxassetid://6031289116"
    ResizeBtn.ImageColor3 = Library.Theme.Accent

    -- (DRAG & RESIZE LOGIC)
    local dragging, dragInput, dragStart, startPos
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = Main.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    local resizing, resStart, resSize
    ResizeBtn.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            resizing = true; resStart = input.Position; resSize = Main.Size
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then resizing = false end end)
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if resizing and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - resStart
            Main.Size = UDim2.new(0, math.clamp(resSize.X.Offset + delta.X, 500, 1000), 0, math.clamp(resSize.Y.Offset + delta.Y, 350, 700))
        end
    end)

    local Window = {}
    local Tabs = {}

    function Window:CreateTab(tName, tIcon)
        local isHome = (#Tabs == 0) -- First tab logic
        local finalName = isHome and "Home" or tName
        local finalIcon = isHome and "home" or tIcon

        local TabBtn = Instance.new("TextButton", TabHolder)
        TabBtn.Size = UDim2.new(1, 0, 0, 34)
        TabBtn.BackgroundTransparency = 1
        TabBtn.Text = ""
        TabBtn.AutoButtonColor = false
        Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)
        
        -- Glossy Stroke for Buttons
        local TStroke = Instance.new("UIStroke", TabBtn)
        TStroke.Color = Color3.new(1,1,1)
        TStroke.Transparency = 1
        TStroke.Thickness = 0.8

        local TIcon = Instance.new("ImageLabel", TabBtn)
        TIcon.Size = UDim2.new(0, 18, 0, 18)
        TIcon.Position = UDim2.new(0, 10, 0.5, -9)
        TIcon.BackgroundTransparency = 1
        TIcon.Image = Library.Theme.Icons[finalIcon] or Library.Theme.Icons["zap"]
        TIcon.ImageColor3 = Library.Theme.SubText

        local TText = Instance.new("TextLabel", TabBtn)
        TText.Text = finalName
        TText.Size = UDim2.new(1, -40, 1, 0)
        TText.Position = UDim2.new(0, 38, 0, 0)
        TText.Font = Enum.Font.GothamMedium
        TText.TextColor3 = Library.Theme.SubText
        TText.TextSize = 13
        TText.BackgroundTransparency = 1 -- INVISIBLE AS REQUESTED
        TText.TextXAlignment = Enum.TextXAlignment.Left

        local Page = Instance.new("CanvasGroup", Content)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.BackgroundTransparency = 1
        Page.Visible = false
        
        local PageScroll = Instance.new("ScrollingFrame", Page)
        PageScroll.Size = UDim2.new(1, 0, 1, 0)
        PageScroll.BackgroundTransparency = 1
        PageScroll.ScrollBarThickness = 0
        Instance.new("UIListLayout", PageScroll).Padding = UDim.new(0, 10)

        local function Select()
            for _, v in pairs(Tabs) do
                v.Page.Visible = false
                QuickTween(v.Btn, {BackgroundTransparency = 1})
                QuickTween(v.Stroke, {Transparency = 1})
                QuickTween(v.Text, {TextColor3 = Library.Theme.SubText})
                QuickTween(v.Icon, {ImageColor3 = Library.Theme.SubText})
            end
            Page.Visible = true
            Page.GroupTransparency = 1
            Page.Position = UDim2.new(0, 15, 0, 0)
            
            QuickTween(Page, {GroupTransparency = 0, Position = UDim2.new(0, 0, 0, 0)})
            QuickTween(TabBtn, {BackgroundTransparency = 0.9})
            QuickTween(TStroke, {Transparency = 0.8})
            QuickTween(TText, {TextColor3 = Library.Theme.Text})
            QuickTween(TIcon, {ImageColor3 = Library.Theme.Accent})
            
            -- Click Animation
            TabBtn.Size = UDim2.new(1, -4, 0, 32)
            TweenService:Create(TabBtn, TweenInfo.new(0.5, Enum.EasingStyle.Back), {Size = UDim2.new(1, 0, 0, 34)}):Play()
        end

        TabBtn.MouseButton1Click:Connect(Select)
        table.insert(Tabs, {Btn = TabBtn, Page = Page, Text = TText, Icon = TIcon, Stroke = TStroke})

        if isHome then Select() end
        
        local Elements = {}
        function Elements:CreateSection(sName)
            local SFrame = Instance.new("Frame", PageScroll)
            SFrame.Size = UDim2.new(1, -5, 0, 40)
            SFrame.BackgroundColor3 = Library.Theme.Main
            SFrame.BackgroundTransparency = 0.7
            Instance.new("UICorner", SFrame).CornerRadius = UDim.new(0, 8)
            Instance.new("UIStroke", SFrame).Color = Library.Theme.Stroke
            
            local STitle = Instance.new("TextLabel", SFrame)
            STitle.Text = sName:upper()
            STitle.Size = UDim2.new(1, -20, 0, 20)
            STitle.Position = UDim2.new(0, 12, 0, 10)
            STitle.Font = Enum.Font.GothamBold
            STitle.TextSize = 11
            STitle.TextColor3 = Library.Theme.Accent
            STitle.BackgroundTransparency = 1
            STitle.TextXAlignment = Enum.TextXAlignment.Left
            
            return {} -- Add element logic here
        end
        return Elements
    end

    return Window
end

return Library
